# Dishcovery 项目验收指南

## 📋 验收前准备

### 1. 环境检查
- ✅ Python 3.8+ 已安装
- ✅ Node.js 18+ 已安装
- ✅ OpenAI API Key 已配置

### 2. 依赖安装
```bash
# 后端依赖
cd backend
pip install -r requirements.txt

# 前端依赖
cd ../frontend
npm install
```

---

## 🔧 后端验收

### 步骤1：启动后端服务

```bash
cd backend
uvicorn main:app --reload
```

### 预期结果1：服务启动成功

**终端应该显示：**
```
INFO:     Will watch for changes in these directories: ['/path/to/backend']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [xxxxx] using WatchFiles
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

**✅ 验收标准：**
- 没有错误信息
- 服务运行在 `http://127.0.0.1:8000`
- 显示 "Application startup complete"

---

### 步骤2：测试根端点

**操作：** 在浏览器访问 `http://127.0.0.1:8000`

### 预期结果2：返回欢迎信息

**浏览器应该显示：**
```json
{"message":"Dishcovery API is running"}
```

**✅ 验收标准：**
- 返回JSON格式
- message字段值为 "Dishcovery API is running"
- HTTP状态码为200

---

### 步骤3：测试API文档

**操作：** 在浏览器访问 `http://127.0.0.1:8000/docs`

### 预期结果3：显示Swagger文档

**浏览器应该显示：**
- FastAPI自动生成的API文档界面
- 可以看到3个API端点：
  - `POST /api/analyze-menu`
  - `POST /api/translate-describe`
  - `POST /api/generate-image`

**✅ 验收标准：**
- 文档页面正常加载
- 所有API端点都可见
- 可以展开查看API详情

---

### 步骤4：测试菜单识别API（使用Swagger UI）

**操作：**
1. 在 `http://127.0.0.1:8000/docs` 页面
2. 找到 `POST /api/analyze-menu`
3. 点击 "Try it out"
4. 点击 "Choose File"，选择一张菜单图片
5. 点击 "Execute"

### 预期结果4：成功识别菜品

**响应应该类似：**
```json
{
  "dish_names": [
    "Caesar Salad",
    "Grilled Chicken",
    "Pasta Carbonara",
    "Tiramisu"
  ]
}
```

**✅ 验收标准：**
- HTTP状态码为200
- 返回JSON格式
- `dish_names` 是数组
- 至少识别出3-5个菜品名称
- 没有错误信息

**❌ 如果失败：**
- 检查 `.env` 文件中的 `OPENAI_API_KEY` 是否正确
- 检查图片是否为有效的菜单图片
- 查看终端错误信息

---

### 步骤5：测试翻译和描述API

**操作：**
1. 在Swagger UI中找到 `POST /api/translate-describe`
2. 点击 "Try it out"
3. 在请求体中输入：
```json
{
  "dish_names": ["Caesar Salad", "Grilled Chicken", "Pasta Carbonara"]
}
```
4. 点击 "Execute"

### 预期结果5：返回翻译和描述

**响应应该类似：**
```json
{
  "dishes": [
    {
      "name": "Caesar Salad",
      "translation": "凯撒沙拉",
      "description": "经典的凯撒沙拉，由新鲜的生菜、烤面包丁、帕尔马干酪和特制凯撒酱制成，口感清爽，是开胃菜的不二之选。"
    },
    {
      "name": "Grilled Chicken",
      "translation": "烤鸡",
      "description": "精选鸡胸肉，经过精心腌制后烤制，外皮金黄酥脆，内里鲜嫩多汁，搭配时令蔬菜，营养丰富。"
    },
    {
      "name": "Pasta Carbonara",
      "translation": "卡波纳拉意面",
      "description": "传统意大利面食，使用培根、鸡蛋、帕尔马干酪和黑胡椒制成，口感浓郁，是意大利经典美食。"
    }
  ]
}
```

**✅ 验收标准：**
- HTTP状态码为200
- 每个菜品都有 `name`、`translation`、`description` 字段
- 翻译是中文
- 描述长度在50-100字左右
- 没有错误信息

---

### 步骤6：测试图片生成API

**操作：**
1. 在Swagger UI中找到 `POST /api/generate-image`
2. 点击 "Try it out"
3. 在请求体中输入：
```json
{
  "dish_name": "Caesar Salad",
  "translation": "凯撒沙拉"
}
```
4. 点击 "Execute"

### 预期结果6：返回图片URL

**响应应该类似：**
```json
{
  "image_url": "https://oaidalleapiprodscus.blob.core.windows.net/..."
}
```

**✅ 验收标准：**
- HTTP状态码为200
- 返回 `image_url` 字段
- URL是有效的HTTPS链接
- 可以在浏览器中打开URL看到生成的图片
- 图片内容是菜品相关

**⏱️ 注意：** 图片生成可能需要10-30秒

---

## 🎨 前端验收

### 步骤1：启动前端服务

```bash
cd frontend
npm run dev
```

### 预期结果1：前端服务启动成功

**终端应该显示：**
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
  ➜  press h + enter to show help
```

**✅ 验收标准：**
- 没有错误信息
- 服务运行在 `http://localhost:5173`
- 显示 "ready" 状态

---

### 步骤2：访问前端页面

**操作：** 在浏览器访问 `http://localhost:5173`

### 预期结果2：页面正常显示

**浏览器应该显示：**
- 页面标题：🍽️ Dishcovery
- 上传区域：显示"点击或拖拽上传菜单照片"
- 页面背景：渐变灰色背景
- 布局：移动端友好的居中布局

**✅ 验收标准：**
- 页面正常加载，无空白
- 样式正确显示
- 没有控制台错误（F12打开开发者工具检查）
- 响应式设计正常

---

### 步骤3：测试图片上传

**操作：**
1. 点击上传区域
2. 选择一张菜单图片
3. 观察页面变化

### 预期结果3：图片上传和预览

**页面应该显示：**
- 图片预览（显示上传的菜单图片）
- 加载提示："正在分析菜单..."
- 加载动画（旋转的圆圈）

**✅ 验收标准：**
- 图片预览正常显示
- 加载状态清晰可见
- 没有错误提示
- 图片大小合适（不超出容器）

---

### 步骤4：等待识别完成

**操作：** 等待3-10秒，直到识别完成

### 预期结果4：显示菜品列表

**页面应该显示：**
- 标题："识别到的菜品 (X)"，X为菜品数量
- 菜品卡片列表，每个卡片包含：
  - 英文菜品名称（大标题）
  - 中文翻译（蓝色文字）
  - 菜品描述（灰色小字）
  - "选择"按钮

**✅ 验收标准：**
- 至少显示3-5个菜品
- 每个菜品都有翻译和描述
- 卡片样式美观
- 布局整齐

---

### 步骤5：测试选择菜品

**操作：**
1. 点击某个菜品的"选择"按钮
2. 观察按钮和卡片的变化

### 预期结果5：选择状态变化

**页面应该显示：**
- 按钮文字变为"已选择"
- 按钮背景变为蓝色
- 卡片边框变为蓝色
- 卡片背景变为浅蓝色
- 显示"正在生成图片..."提示

**✅ 验收标准：**
- 选择状态视觉反馈明显
- 按钮状态正确切换
- 卡片高亮显示
- 加载提示出现

---

### 步骤6：等待图片生成

**操作：** 等待10-30秒，直到图片生成完成

### 预期结果6：显示生成的图片

**页面应该显示：**
- 在菜品卡片下方显示生成的图片
- 图片清晰可见
- 图片内容与菜品相关

**✅ 验收标准：**
- 图片正常加载显示
- 图片大小合适
- 图片内容与菜品匹配
- 没有加载错误

---

### 步骤7：测试多个菜品选择

**操作：**
1. 选择多个菜品（点击多个"选择"按钮）
2. 观察图片生成过程

### 预期结果7：多个菜品图片生成

**页面应该显示：**
- 每个选中的菜品都显示"正在生成图片..."
- 图片按顺序生成并显示
- 可以同时看到多个生成的图片

**✅ 验收标准：**
- 支持多选功能
- 图片逐个生成
- 所有图片都能正常显示
- 没有冲突或错误

---

### 步骤8：测试移动端显示

**操作：**
1. 打开浏览器开发者工具（F12）
2. 切换到移动设备视图（点击设备图标）
3. 选择iPhone或Android设备尺寸
4. 刷新页面

### 预期结果8：移动端适配良好

**页面应该显示：**
- 布局适配移动端屏幕
- 文字大小合适
- 按钮大小适合触摸
- 图片显示正常
- 没有横向滚动条

**✅ 验收标准：**
- 在375px宽度下显示正常
- 所有元素可见且可操作
- 触摸目标大小合适（至少44x44px）
- 响应式布局正确

---

## 🔗 集成验收（完整流程）

### 完整流程测试

**操作步骤：**
1. ✅ 启动后端服务
2. ✅ 启动前端服务
3. ✅ 访问前端页面
4. ✅ 上传菜单图片
5. ✅ 等待识别完成
6. ✅ 查看翻译和描述
7. ✅ 选择感兴趣的菜品
8. ✅ 等待图片生成
9. ✅ 查看生成的图片

### 预期结果：完整流程顺畅

**✅ 验收标准：**
- 所有步骤都能顺利完成
- 每个步骤都有清晰的反馈
- 没有卡顿或长时间等待（除了图片生成）
- 错误情况有友好提示
- 可以重复使用（上传新图片）

---

## ❌ 常见问题排查

### 后端问题

**问题1：服务启动失败**
- 检查Python版本：`python --version`
- 检查依赖安装：`pip list | grep fastapi`
- 检查端口占用：`lsof -i :8000`

**问题2：API返回500错误**
- 检查 `.env` 文件中的 `OPENAI_API_KEY`
- 查看终端错误信息
- 检查API Key是否有效

**问题3：识别失败**
- 确保上传的是清晰的菜单图片
- 检查图片格式（支持JPEG, PNG, GIF, WEBP）
- 检查图片大小（小于10MB）

### 前端问题

**问题1：页面空白**
- 检查控制台错误（F12）
- 检查 `npm install` 是否完成
- 检查端口5173是否被占用

**问题2：无法连接后端**
- 确认后端服务正在运行
- 检查CORS配置
- 检查API地址是否正确

**问题3：图片上传失败**
- 检查网络连接
- 检查后端服务状态
- 查看浏览器控制台错误

---

## ✅ 验收检查清单

### 后端验收清单
- [ ] 服务可以正常启动
- [ ] 根端点返回正确响应
- [ ] API文档可以访问
- [ ] 菜单识别API正常工作
- [ ] 翻译和描述API正常工作
- [ ] 图片生成API正常工作
- [ ] 错误处理正常

### 前端验收清单
- [ ] 前端服务可以正常启动
- [ ] 页面正常显示
- [ ] 图片上传功能正常
- [ ] 图片预览正常
- [ ] 菜品列表显示正常
- [ ] 选择功能正常
- [ ] 图片生成和显示正常
- [ ] 移动端适配良好
- [ ] 加载状态提示正常
- [ ] 错误提示友好

### 集成验收清单
- [ ] 完整流程可以走通
- [ ] 前后端通信正常
- [ ] 数据流正确
- [ ] 用户体验良好

---

## 📊 验收通过标准

**✅ 验收通过需要满足：**
1. 所有后端API端点正常工作
2. 所有前端功能正常工作
3. 完整流程可以顺畅走通
4. 移动端显示正常
5. 错误处理友好
6. 没有严重bug

**如果以上所有项目都满足，则验收通过！** ✅

